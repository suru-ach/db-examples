create table if not exists app_users (
    id          serial          primary key,
    username    varchar(255)    not null,
    phoneNumber varchar(10)     not null
);

create table if not exists items_list (
    id          serial             primary key,
    itemname    varchar(255)    not null,
    price       decimal(4,2)    not null,
    issuedate   date            not null
);

create table if not exists orders (
    id          serial primary key,
    userid      int,
    constraint fk_users_orders
        foreign key (userid) references app_users(id) on update cascade on delete set null
);

create table if not exists order_items (
    orderid     int,
    itemid      int,
    primary key(orderid, itemid),
    constraint fk_order_items
        foreign key (orderid) references orders(id) on update cascade on delete set null,
    constraint fk_items_order
        foreign key (itemid) references items_list(id) on update cascade on delete set null
);

-- queries

select username, count(*) as total_orders
from (
select app_users.username
from app_users
join orders 
on orders.userid = app_users.id
order by app_users.username
)
group by username
order by count(*) desc;

-- most number of products bought
-- uesrs who bought the most products







-- alter table app_users add column id serial primary key;

insert into app_users
values
(default, 'rsydney0','3006728282'),
(default, 'ebroggini1','3299504869'),
(default, 'bgunbie2','9175660909'),
(default, 'kfigure3','5127126801'),
(default, 'hbowman4','5465022672'),
(default, 'hfinden5','4209142537'),
(default, 'heliasson6','9929177440'),
(default, 'tstickells7','2604500712'),
(default, 'sbrocks8','7582115260'),
(default, 'iaindrais9','1899380371'),
(default, 'ftheodorea','2896045211'),
(default, 'bwastlingb','1322000980'),
(default, 'gkobierrac','1746377799'),
(default, 'lstearnd','3668125266'),
(default, 'efriatte','1181798121'),
(default, 'jentreisf','8368207792'),
(default, 'hgodardg','9048872678'),
(default, 'vrozeah','7739721870'),
(default, 'ckrzysztofiaki','3698820118'),
(default, 'jarchbellj','8915511054'),
(default, 'mduckettk','6203700399'),
(default, 'jgoudiel','9591594098'),
(default, 'maugustm','2163624050'),
(default, 'gaudissn','6773778394'),
(default, 'kheinigo','1274284347'),
(default, 'wlokierp','8337681658'),
(default, 'hgoodenq','2342653520'),
(default, 'roviser','3922438599'),
(default, 'mleballs','4926182302'),
(default, 'bdurnant','4323180294'),
(default, 'cmathysu','1686508296'),
(default, 'rgoodaylev','2077359681'),
(default, 'tmclachlanw','2292261797'),
(default, 'mshakespearx','5548915803'),
(default, 'rgronousy','3233623152'),
(default, 'dhindrickz','7906432830'),
(default, 'bnavarijo10','8071163840'),
(default, 'jjudson11','1366270461'),
(default, 'aekins12','6778326096'),
(default, 'yvedishchev13','6296839775'),
(default, 'gkarpov14','6042357211'),
(default, 'tbrendeke15','1649783474'),
(default, 'etraill16','1474438988'),
(default, 'jjurasz17','6272882523'),
(default, 'lmcclay18','6747212743'),
(default, 'llammert19','4887334911'),
(default, 'minns1a','5088956965'),
(default, 'bhandrik1b','3834939796'),
(default, 'jburl1c','1338056489'),
(default, 'flambarton1d','8197758505'),
(default, 'rschole1e','8264789521'),
(default, 'jbenzies1f','5086082468'),
(default, 'zfellow1g','2434924991'),
(default, 'cregis1h','8459441737'),
(default, 'redgett1i','3432161507'),
(default, 'vpreator1j','8188135982'),
(default, 'ddilks1k','3752402901'),
(default, 'pcanton1l','9435304632'),
(default, 'lrivard1m','7465025938'),
(default, 'squade1n','9679555339'),
(default, 'mcolling1o','4724370838'),
(default, 'hgarrigan1p','5187782472'),
(default, 'gbriat1q','1693730312'),
(default, 'tvondra1r','2611787436'),
(default, 'btrillo1s','8625836707'),
(default, 'mparkins1t','7282809495'),
(default, 'fspargo1u','8835773623'),
(default, 'emargrie1v','7962096181'),
(default, 'icrippell1w','4658379736'),
(default, 'msings1x','9783666849'),
(default, 'rmctague1y','2659753131'),
(default, 'cbohlsen1z','2334731138'),
(default, 'ahawksby20','7575653417'),
(default, 'achastand21','4103117406'),
(default, 'kfrostdicke22','2482037968'),
(default, 'awillingham23','9946667358'),
(default, 'sdomino24','8374905066'),
(default, 'cfletcher25','2483729245'),
(default, 'kmustoe26','4691152252'),
(default, 'tredhole27','1582433683'),
(default, 'lheningam28','5093529225'),
(default, 'zcumberlidge29','8712786616'),
(default, 'bloomis2a','8308676471'),
(default, 'wskinley2b','2821676679'),
(default, 'nschulter2c','3786449075'),
(default, 'bjaneway2d','5539876528'),
(default, 'ssquire2e','6922324248'),
(default, 'swestrip2f','3743347956'),
(default, 'dstubs2g','7054922850'),
(default, 'vjacob2h','4038047502'),
(default, 'nraymont2i','5976381685'),
(default, 'mvolante2j','9124292570'),
(default, 'rearry2k','8921207663'),
(default, 'esmalman2l','3441259489'),
(default, 'tsykora2m','7349874686'),
(default, 'mprestige2n','9766743066'),
(default, 'acarlisi2o','6933411295'),
(default, 'ncrab2p','6301339352'),
(default, 'mramirez2q','1209688818'),
(default, 'jvale2r','8313138595');

insert into items_list
values
(default, 'Pepper Squash',54.13,'2023-12-26'),
(default, 'Chicken Breast Wing On',13.74,'2024-06-14'),
(default, 'Fish - Scallops',71.61,'2023-11-26'),
(default, 'Mushroom - King Eryingii',17.37,'2024-04-07'),
(default, 'Basil - Thai',56.18,'2024-05-07'),
(default, 'Cheese - Cheddar With Claret',29.64,'2024-02-26'),
(default, 'Juice - Propel Sport',40.34,'2024-04-27'),
(default, 'Pepper - Red',34.29,'2023-12-05'),
(default, 'Salt And Pepper Mix - White',89.64,'2024-08-04'),
(default, 'Lime Cordial - Roses',88.33,'2023-11-30'),
(default, 'The Pop Shoppe - Cream Soda',85.33,'2024-05-15'),
(default, 'Dasheen',40.07,'2024-04-12'),
(default, 'Russian Prince',45.71,'2023-12-07'),
(default, 'Wine - Ej Gallo Sierra Valley',93.05,'2023-11-10'),
(default, 'Ranchero - Primerba',26.42,'2023-10-09'),
(default, 'Wine - Jackson Triggs Okonagan',54.51,'2024-06-18'),
(default, 'Chicken - Wieners',59.39,'2023-09-22'),
(default, 'C - Plus',25.82,'2024-01-03'),
(default, 'Appetizer - Crab And Brie',61.85,'2023-11-21'),
(default, 'Tea - Darjeeling',41.38,'2024-02-27'),
(default, 'Containter - 3oz Microwave Rect.',84.15,'2024-07-24'),
(default, 'Pepper - Chilli Seeds Mild',29.96,'2024-01-24'),
(default, 'Poppy Seed',75.14,'2024-05-25'),
(default, 'Irish Cream - Baileys',78.73,'2024-03-16'),
(default, 'Daikon Radish',18.33,'2024-07-23'),
(default, 'Chocolate Bar - Coffee Crisp',23.02,'2023-12-26'),
(default, 'Tuna - Yellowfin',54.53,'2023-11-14'),
(default, 'Cinnamon Rolls',26.54,'2023-10-09'),
(default, 'Crab - Meat Combo',34.38,'2024-01-13');


insert into orders
values
(default,50),
(default,6),
(default,62),
(default,9),
(default,17),
(default,41),
(default,29),
(default,7),
(default,62),
(default,15),
(default,44),
(default,92),
(default,55),
(default,55),
(default,7),
(default,17),
(default,23),
(default,35),
(default,51),
(default,77),
(default,33),
(default,76),
(default,6),
(default,6),
(default,4),
(default,48),
(default,40),
(default,54),
(default,82),
(default,31),
(default,50),
(default,79),
(default,85),
(default,2),
(default,40),
(default,49),
(default,1),
(default,51),
(default,30),
(default,40),
(default,44),
(default,62),
(default,69),
(default,12),
(default,89),
(default,92),
(default,4),
(default,36),
(default,64),
(default,52),
(default,15),
(default,75),
(default,91),
(default,84),
(default,13),
(default,26),
(default,55),
(default,53),
(default,54),
(default,100),
(default,27),
(default,77),
(default,81),
(default,77),
(default,51),
(default,22),
(default,28),
(default,33),
(default,18),
(default,28),
(default,32),
(default,57),
(default,92),
(default,60),
(default,75),
(default,34),
(default,94),
(default,32),
(default,12),
(default,98),
(default,96),
(default,91),
(default,37),
(default,59),
(default,51),
(default,49),
(default,13),
(default,67),
(default,15),
(default,59),
(default,50),
(default,90),
(default,8),
(default,47),
(default,17),
(default,49),
(default,96),
(default,48),
(default,27),
(default,75),
(default,85),
(default,77),
(default,15),
(default,32),
(default,9),
(default,35),
(default,61),
(default,50),
(default,69),
(default,22),
(default,63),
(default,34),
(default,21),
(default,74),
(default,100),
(default,30),
(default,96),
(default,27),
(default,81),
(default,84),
(default,54),
(default,48),
(default,18),
(default,62),
(default,39),
(default,5),
(default,12),
(default,65),
(default,8),
(default,63),
(default,27),
(default,21),
(default,16),
(default,22),
(default,45),
(default,10),
(default,74),
(default,12),
(default,81),
(default,77),
(default,42),
(default,18),
(default,87),
(default,100),
(default,4),
(default,83),
(default,55),
(default,46),
(default,55),
(default,1),
(default,16),
(default,76),
(default,44),
(default,50),
(default,64),
(default,87),
(default,91),
(default,71),
(default,66),
(default,36),
(default,63),
(default,81),
(default,52),
(default,59),
(default,47),
(default,38),
(default,6),
(default,24),
(default,79),
(default,99),
(default,27),
(default,26),
(default,72),
(default,13),
(default,87),
(default,36),
(default,63),
(default,35),
(default,73),
(default,61),
(default,12),
(default,68),
(default,85),
(default,79),
(default,39),
(default,38),
(default,24),
(default,83),
(default,95),
(default,51),
(default,34),
(default,90),
(default,25),
(default,80),
(default,5),
(default,49),
(default,31),
(default,88),
(default,42),
(default,71);

insert into order_items
(orderid, itemid)
values
(1,21),
(1,22),
(1,25),
(10,1),
(10,15),
(10,18),
(10,19),
(10,21),
(10,25),
(10,29),
(10,3),
(10,5),
(10,6),
(100,1),
(100,12),
(100,14),
(100,7),
(101,11),
(101,14),
(101,18),
(101,28),
(101,6),
(101,8),
(102,1),
(102,12),
(102,4),
(103,11),
(103,12),
(103,17),
(103,19),
(103,24),
(103,26),
(103,29),
(104,14),
(104,15),
(104,22),
(104,26),
(104,27),
(104,7),
(104,8),
(105,4),
(106,1),
(106,16),
(106,19),
(106,24),
(107,11),
(107,15),
(107,16),
(107,17),
(108,1),
(108,11),
(108,12),
(108,20),
(108,21),
(108,24),
(108,27),
(108,28),
(109,21),
(109,28),
(109,29),
(11,24),
(11,3),
(110,16),
(110,21),
(110,26),
(110,8),
(112,18),
(112,21),
(112,22),
(112,28),
(112,3),
(112,7),
(113,23),
(113,27),
(114,10),
(114,20),
(114,24),
(114,27),
(115,10),
(115,17),
(115,18),
(115,22),
(115,27),
(115,9),
(116,11),
(116,13),
(116,16),
(116,18),
(116,20),
(116,27),
(116,28),
(117,21),
(117,26),
(117,28),
(117,8),
(118,21),
(118,22),
(118,25),
(119,15),
(119,26),
(119,3),
(12,26),
(12,3),
(12,7),
(120,5),
(120,9),
(121,13),
(121,18),
(121,19),
(121,3),
(121,8),
(122,10),
(122,12),
(122,14),
(122,15),
(122,23),
(122,29),
(122,3),
(123,1),
(123,12),
(123,15),
(123,27),
(123,4),
(123,9),
(124,25),
(124,27),
(125,1),
(125,10),
(125,18),
(125,29),
(125,3),
(125,8),
(126,1),
(126,15),
(126,20),
(126,26),
(126,29),
(126,3),
(126,6),
(127,20),
(127,21),
(127,22),
(127,24),
(127,4),
(127,6),
(128,18),
(128,2),
(128,23),
(129,12),
(129,13),
(129,16),
(129,26),
(129,27),
(13,1),
(13,11),
(13,13),
(13,7),
(13,8),
(130,1),
(130,24),
(130,3),
(131,1),
(131,16),
(131,17),
(131,2),
(131,3),
(132,13),
(132,14),
(132,17),
(132,26),
(132,28),
(132,29),
(132,5),
(133,12),
(133,21),
(133,24),
(133,29),
(134,1),
(134,12),
(134,23),
(134,28),
(134,4),
(135,19),
(135,2),
(135,27),
(136,11),
(136,16),
(136,24),
(136,28),
(136,3),
(136,9),
(137,12),
(137,13),
(137,20),
(137,28),
(138,12),
(138,20),
(138,4),
(138,9),
(139,17),
(139,19),
(139,23),
(139,24),
(139,3),
(139,4),
(139,8),
(14,11),
(14,12),
(14,13),
(14,19),
(14,29),
(14,3),
(14,4),
(14,6),
(14,8),
(140,10),
(140,11),
(140,3),
(140,8),
(141,11),
(141,14),
(141,20),
(141,24),
(142,18),
(142,21),
(142,24),
(142,28),
(143,17),
(143,22),
(143,24),
(143,26),
(143,27),
(143,7),
(144,16),
(144,22),
(144,24),
(144,25),
(144,29),
(145,19),
(145,25),
(145,27),
(146,17),
(146,20),
(146,22),
(147,14),
(147,20),
(147,8),
(147,9),
(149,11),
(149,13),
(149,19),
(149,20),
(149,22),
(149,26),
(149,29),
(149,4),
(149,6),
(15,16),
(15,19),
(15,24),
(15,26),
(15,4),
(150,11),
(150,12),
(150,19),
(150,20),
(150,4),
(150,5),
(150,6),
(150,7),
(150,8),
(151,10),
(151,21),
(151,27),
(152,11),
(152,22),
(152,24),
(152,3),
(152,4),
(152,8),
(153,20),
(153,9),
(154,1),
(154,10),
(154,13),
(154,14),
(154,2),
(154,25),
(154,26),
(155,16),
(155,18),
(155,3),
(155,9),
(156,22),
(156,24),
(156,25),
(156,26),
(156,28),
(156,4),
(157,12),
(157,20),
(157,24),
(157,29),
(158,11),
(158,13),
(158,5),
(158,7),
(159,11),
(159,13),
(159,18),
(159,22),
(159,28),
(16,1),
(16,17),
(16,3),
(16,8),
(160,1),
(160,2),
(160,26),
(160,27),
(160,9),
(161,10),
(161,24),
(161,27),
(161,5),
(162,12),
(162,24),
(163,10),
(163,12),
(163,13),
(163,18),
(163,20),
(163,3),
(163,7),
(164,17),
(164,20),
(164,25),
(164,29),
(164,4),
(165,1),
(165,23),
(165,5),
(166,1),
(166,28),
(166,9),
(167,14),
(167,21),
(167,5),
(167,6),
(168,13),
(168,21),
(169,1),
(169,18),
(169,19),
(169,26),
(169,29),
(169,3),
(169,7),
(169,8),
(169,9),
(17,10),
(17,11),
(17,2),
(17,21),
(17,27),
(17,5),
(170,12),
(170,26),
(170,27),
(171,18),
(171,19),
(171,20),
(172,15),
(172,2),
(172,3),
(172,9),
(173,16),
(173,17),
(173,2),
(173,20),
(173,22),
(173,28),
(173,6),
(173,8),
(174,20),
(174,29),
(174,5),
(175,10),
(175,21),
(175,23),
(175,27),
(175,3),
(175,5),
(175,6),
(176,21),
(177,11),
(177,2),
(177,27),
(178,21),
(178,29),
(179,11),
(179,22),
(179,27),
(179,5),
(18,14),
(18,26),
(18,27),
(18,3),
(180,15),
(180,22),
(180,25),
(180,4),
(181,13),
(181,14),
(181,19),
(181,2),
(181,22),
(181,25),
(181,27),
(182,16),
(182,19),
(182,20),
(182,21),
(182,25),
(182,4),
(182,6),
(182,9),
(183,10),
(183,23),
(183,24),
(183,26),
(183,27),
(183,4),
(184,13),
(184,14),
(184,21),
(184,24),
(185,19),
(185,25),
(185,27),
(185,5),
(186,1),
(186,13),
(186,14),
(186,20),
(186,21),
(186,3),
(186,6),
(187,2),
(187,24),
(187,25),
(187,27),
(188,11),
(188,23),
(188,4),
(188,7),
(189,11),
(189,19),
(189,2),
(189,20),
(189,23),
(189,25),
(189,6),
(19,1),
(19,10),
(19,11),
(19,18),
(19,22),
(19,23),
(190,11),
(190,24),
(190,26),
(190,3),
(190,6),
(191,19),
(191,21),
(191,23),
(192,22),
(193,11),
(193,20),
(193,22),
(194,10),
(194,11),
(194,19),
(194,20),
(194,22),
(194,29),
(194,4),
(195,14),
(195,25),
(195,9),
(196,19),
(196,22),
(196,24),
(196,28),
(196,5),
(197,13),
(197,17),
(197,18),
(197,21),
(197,23),
(197,25),
(198,27),
(199,14),
(199,15),
(199,25),
(199,28),
(199,4),
(2,16),
(2,28),
(20,12),
(20,16),
(20,20),
(20,24),
(20,6),
(200,17),
(200,22),
(200,3),
(200,6),
(200,7),
(21,14),
(21,26),
(21,6),
(22,11),
(22,2),
(22,22),
(22,26),
(22,8),
(22,9),
(23,16),
(23,19),
(23,23),
(23,25),
(23,26),
(23,8),
(24,11),
(24,16),
(24,3),
(24,6),
(25,11),
(25,17),
(25,2),
(25,29),
(25,9),
(26,18),
(26,3),
(26,4),
(26,6),
(27,10),
(27,29),
(28,1),
(28,12),
(28,20),
(28,22),
(28,26),
(28,6),
(29,1),
(29,16),
(29,17),
(29,21),
(29,23),
(3,15),
(3,2),
(3,29),
(30,13),
(30,24),
(30,28),
(31,5),
(31,8),
(32,11),
(32,12),
(32,17),
(32,29),
(32,3),
(33,22),
(33,6),
(33,7),
(34,14),
(34,28),
(35,11),
(35,13),
(35,27),
(36,16),
(36,18),
(36,20),
(36,22),
(36,26),
(36,4),
(36,9),
(37,12),
(37,8),
(38,12),
(38,13),
(38,17),
(38,20),
(38,21),
(38,24),
(38,4),
(38,9),
(39,27),
(4,2),
(4,29),
(4,4),
(4,5),
(4,9),
(40,12),
(40,2),
(40,26),
(40,27),
(40,29),
(40,9),
(41,18),
(41,20),
(41,26),
(41,9),
(42,1),
(42,15),
(42,17),
(42,8),
(43,15),
(43,18),
(43,21),
(44,5),
(44,7),
(45,17),
(45,19),
(45,24),
(45,25),
(45,5),
(45,8),
(46,1),
(46,25),
(46,28),
(46,5),
(47,14),
(47,18),
(47,25),
(47,5),
(47,8),
(48,1),
(48,27),
(48,29),
(48,6),
(48,8),
(49,14),
(49,15),
(49,23),
(49,26),
(49,27),
(5,11),
(5,12),
(5,16),
(5,2),
(5,9),
(50,15),
(50,17),
(50,24),
(50,6),
(51,10),
(51,13),
(51,22),
(51,23),
(51,28),
(51,7),
(52,11),
(52,13),
(52,15),
(52,16),
(52,19),
(52,2),
(52,25),
(52,26),
(52,6),
(53,2),
(53,3),
(53,4),
(53,5),
(54,11),
(55,1),
(55,16),
(55,2),
(55,22),
(56,16),
(56,19),
(56,26),
(57,22),
(57,25),
(58,1),
(58,11),
(58,12),
(58,20),
(58,29),
(58,4),
(58,6),
(59,10),
(59,16),
(59,17),
(59,28),
(59,8),
(6,12),
(6,13),
(6,18),
(6,20),
(6,22),
(6,4),
(60,15),
(60,22),
(60,9),
(61,13),
(61,22),
(61,23),
(61,29),
(62,2),
(62,20),
(62,24),
(62,29),
(62,9),
(63,10),
(63,12),
(63,3),
(63,6),
(63,9),
(64,12),
(64,2),
(64,22),
(64,24),
(64,6),
(64,8),
(65,19),
(65,9),
(66,1),
(66,14),
(66,2),
(66,23),
(67,18),
(67,26),
(67,29),
(67,6),
(68,16),
(68,2),
(69,14),
(69,16),
(69,21),
(69,22),
(69,24),
(69,25),
(69,8),
(7,24),
(7,25),
(7,26),
(70,10),
(70,23),
(70,24),
(70,7),
(71,18),
(71,25),
(72,10),
(72,14),
(72,18),
(72,24),
(72,27),
(72,28),
(73,11),
(73,12),
(73,13),
(73,17),
(73,18),
(73,22),
(73,24),
(73,29),
(73,5),
(73,8),
(74,16),
(74,17),
(74,25),
(75,15),
(75,24),
(75,5),
(75,6),
(75,9),
(76,18),
(76,8),
(77,1),
(77,19),
(77,23),
(77,5),
(78,11),
(78,12),
(78,15),
(78,16),
(78,18),
(78,28),
(78,3),
(79,1),
(79,16),
(79,20),
(79,22),
(79,5),
(8,12),
(8,15),
(8,21),
(8,4),
(8,6),
(80,10),
(80,2),
(80,21),
(80,23),
(80,3),
(80,4),
(80,5),
(81,10),
(81,14),
(81,18),
(81,23),
(81,8),
(82,19),
(82,23),
(82,4),
(82,6),
(83,13),
(83,17),
(83,22),
(83,23),
(84,14),
(84,18),
(84,2),
(84,26),
(84,4),
(84,7),
(84,9),
(85,15),
(85,18),
(85,9),
(86,1),
(86,18),
(86,22),
(86,5),
(87,14),
(87,16),
(87,21),
(87,24),
(87,26),
(87,28),
(87,5),
(87,9),
(88,23),
(88,29),
(88,4),
(88,5),
(88,8),
(89,13),
(89,24),
(89,28),
(89,5),
(89,6),
(89,7),
(9,14),
(9,18),
(9,20),
(9,22),
(9,4),
(90,13),
(90,16),
(90,2),
(90,21),
(90,25),
(90,27),
(90,28),
(90,4),
(90,9),
(91,11),
(91,2),
(91,26),
(91,29),
(92,10),
(92,16),
(92,26),
(93,20),
(93,22),
(93,25),
(93,27),
(94,12),
(94,14),
(94,16),
(94,24),
(95,12),
(95,16),
(95,20),
(95,27),
(95,3),
(96,13),
(96,20),
(96,6),
(96,8),
(97,14),
(97,16),
(97,27),
(98,26),
(98,6),
(99,20),
(99,24),
(99,4),
(99,6);
